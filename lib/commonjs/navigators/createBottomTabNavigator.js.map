{"version":3,"sources":["createBottomTabNavigator.tsx"],"names":["TabNavigationView","state","loaded","props","navigation","index","_getButtonComponent","route","descriptors","descriptor","key","options","tabBarButtonComponent","undefined","_renderTabBar","tabBarComponent","TabBarComponent","BottomTabBar","tabBarOptions","screenProps","getLabelText","getAccessibilityLabel","getAccessibilityRole","getAccessibilityStates","getTestID","renderIcon","onTabPress","onTabLongPress","routes","tabBarVisible","_jumpTo","onIndexChange","findIndex","renderScene","lazy","styles","container","pages","map","includes","isFocused","StyleSheet","absoluteFill","nextProps","prevState","React","PureComponent","defaultProps","focused","create","flex","overflow"],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport {\r\n  View,\r\n  StyleSheet,\r\n  AccessibilityRole,\r\n  AccessibilityState,\r\n} from 'react-native';\r\nimport { NavigationRoute } from 'react-navigation';\r\n\r\n// eslint-disable-next-line import/no-unresolved\r\nimport { ScreenContainer } from 'react-native-screens';\r\n\r\nimport createTabNavigator, {\r\n  NavigationViewProps,\r\n} from '../utils/createTabNavigator';\r\nimport BottomTabBar from '../views/BottomTabBar';\r\nimport ResourceSavingScene from '../views/ResourceSavingScene';\r\nimport {\r\n  NavigationTabProp,\r\n  NavigationBottomTabOptions,\r\n  BottomTabBarOptions,\r\n  SceneDescriptorMap,\r\n} from '../types';\r\n\r\ntype Config = {\r\n  lazy?: boolean;\r\n  tabBarComponent?: React.ComponentType<any>;\r\n  tabBarOptions?: BottomTabBarOptions;\r\n};\r\n\r\ntype Props = NavigationViewProps &\r\n  Config & {\r\n    getAccessibilityRole: (props: {\r\n      route: NavigationRoute;\r\n    }) => AccessibilityRole | undefined;\r\n    getAccessibilityStates: (props: {\r\n      route: NavigationRoute;\r\n      focused: boolean;\r\n    }) => AccessibilityState[];\r\n    navigation: NavigationTabProp;\r\n    descriptors: SceneDescriptorMap;\r\n    screenProps?: unknown;\r\n  };\r\n\r\ntype State = {\r\n  loaded: number[];\r\n};\r\n\r\nclass TabNavigationView extends React.PureComponent<Props, State> {\r\n  static defaultProps = {\r\n    lazy: true,\r\n    getAccessibilityRole: (): AccessibilityRole => 'button',\r\n    getAccessibilityStates: ({\r\n      focused,\r\n    }: {\r\n      focused: boolean;\r\n    }): AccessibilityState[] => (focused ? ['selected'] : []),\r\n  };\r\n\r\n  static getDerivedStateFromProps(nextProps: Props, prevState: State) {\r\n    const { index } = nextProps.navigation.state;\r\n\r\n    return {\r\n      // Set the current tab to be loaded if it was not loaded before\r\n      loaded: prevState.loaded.includes(index)\r\n        ? prevState.loaded\r\n        : [...prevState.loaded, index],\r\n    };\r\n  }\r\n\r\n  state = {\r\n    loaded: [this.props.navigation.state.index],\r\n  };\r\n\r\n  _getButtonComponent = ({ route }: { route: NavigationRoute }) => {\r\n    const { descriptors } = this.props;\r\n    const descriptor = descriptors[route.key];\r\n    const options = descriptor.options;\r\n\r\n    if (options.tabBarButtonComponent) {\r\n      return options.tabBarButtonComponent;\r\n    }\r\n\r\n    return undefined;\r\n  };\r\n\r\n  _renderTabBar = () => {\r\n    const {\r\n      tabBarComponent: TabBarComponent = BottomTabBar,\r\n      tabBarOptions,\r\n      navigation,\r\n      screenProps,\r\n      getLabelText,\r\n      getAccessibilityLabel,\r\n      getAccessibilityRole,\r\n      getAccessibilityStates,\r\n      getTestID,\r\n      renderIcon,\r\n      onTabPress,\r\n      onTabLongPress,\r\n    } = this.props;\r\n\r\n    const { descriptors } = this.props;\r\n    const { state } = this.props.navigation;\r\n    const route = state.routes[state.index];\r\n    const descriptor = descriptors[route.key];\r\n    const options = descriptor.options;\r\n\r\n    if (options.tabBarVisible === false) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <TabBarComponent\r\n        {...tabBarOptions}\r\n        jumpTo={this._jumpTo}\r\n        navigation={navigation}\r\n        screenProps={screenProps}\r\n        onTabPress={onTabPress}\r\n        onTabLongPress={onTabLongPress}\r\n        getLabelText={getLabelText}\r\n        getButtonComponent={this._getButtonComponent}\r\n        getAccessibilityLabel={getAccessibilityLabel}\r\n        getAccessibilityRole={getAccessibilityRole}\r\n        getAccessibilityStates={getAccessibilityStates}\r\n        getTestID={getTestID}\r\n        renderIcon={renderIcon}\r\n      />\r\n    );\r\n  };\r\n\r\n  _jumpTo = (key: string) => {\r\n    const { navigation, onIndexChange } = this.props;\r\n\r\n    const index = navigation.state.routes.findIndex(route => route.key === key);\r\n\r\n    onIndexChange(index);\r\n  };\r\n\r\n  render() {\r\n    const { navigation, renderScene, lazy } = this.props;\r\n    const { routes } = navigation.state;\r\n    const { loaded } = this.state;\r\n\r\n    return (\r\n      <View style={styles.container}>\r\n        <ScreenContainer style={styles.pages}>\r\n          {routes.map((route, index) => {\r\n            if (lazy && !loaded.includes(index)) {\r\n              // Don't render a screen if we've never navigated to it\r\n              return null;\r\n            }\r\n\r\n            const isFocused = navigation.state.index === index;\r\n\r\n            return (\r\n              <ResourceSavingScene\r\n                key={route.key}\r\n                style={StyleSheet.absoluteFill}\r\n                isVisible={isFocused}\r\n              >\r\n                {renderScene({ route })}\r\n              </ResourceSavingScene>\r\n            );\r\n          })}\r\n        </ScreenContainer>\r\n        {this._renderTabBar()}\r\n      </View>\r\n    );\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    overflow: 'hidden',\r\n  },\r\n  pages: {\r\n    flex: 1,\r\n  },\r\n});\r\n\r\nexport default createTabNavigator<Config, NavigationBottomTabOptions, Props>(\r\n  TabNavigationView\r\n);\r\n"]}